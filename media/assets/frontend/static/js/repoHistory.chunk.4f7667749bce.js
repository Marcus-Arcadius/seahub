(this["webpackJsonpseahub-frontend"]=this["webpackJsonpseahub-frontend"]||[]).push([[13],{1553:function(e,t,a){a(49),e.exports=a(1676)},1554:function(e,t,a){},1676:function(e,t,a){"use strict";a.r(t);var i=a(6),r=a(7),s=a(9),n=a(8),c=a(2),o=a.n(c),l=a(21),b=a.n(l),d=a(15),h=a(13),m=a.n(h),j=a(5),u=a(1),g=a(10),p=a(14),O=a(33),f=a(18),x=a(47),D=a(289),v=a(4),P=a(228),w=a.n(P),L=a(11),C=a(0),M=function(e){Object(s.a)(a,e);var t=Object(n.a)(a);function a(e){var r;return Object(i.a)(this,a),(r=t.call(this,e)).handleInputChange=function(e){r.setState({inputValue:e})},r.formSubmit=function(){var e=r.state.inputValue.map((function(e,t){return e.value})).join(","),t=r.props,a=t.repoID,i=t.commitID;r.setState({submitBtnDisabled:!0}),g.a.updateRepoCommitLabels(a,i,e).then((function(e){r.props.updateCommitLabels(e.data.revisionTags.map((function(e,t){return e.tag}))),r.props.toggleDialog(),L.a.success(Object(u.rb)("Successfully edited labels."))})).catch((function(e){var t=j.a.getErrorMsg(e);r.setState({formErrorMsg:t,submitBtnDisabled:!1})}))},r.state={inputValue:r.props.commitLabels.map((function(e,t){return{label:e,value:e}})),submitBtnDisabled:!1},r}return Object(r.a)(a,[{key:"render",value:function(){var e=this.state.formErrorMsg;return Object(C.jsxs)(v.u,{isOpen:!0,centered:!0,toggle:this.props.toggleDialog,children:[Object(C.jsx)(v.x,{toggle:this.props.toggleDialog,children:Object(u.rb)("Edit labels")}),Object(C.jsx)(v.v,{children:Object(C.jsxs)(o.a.Fragment,{children:[Object(C.jsx)(w.a,{defaultValue:this.props.commitLabels.map((function(e,t){return{label:e,value:e}})),isMulti:!0,onChange:this.handleInputChange,placeholder:""}),e&&Object(C.jsx)("p",{className:"error m-0 mt-2",children:e})]})}),Object(C.jsx)(v.w,{children:Object(C.jsx)("button",{className:"btn btn-primary",disabled:this.state.submitBtnDisabled,onClick:this.formSubmit,children:Object(u.rb)("Submit")})})]})}}]),a}(o.a.Component),y=(a(113),a(128),a(1554),window.app.pageOptions),N=y.repoID,S=y.repoName,k=y.userPerm,I=y.showLabel,_=function(e){Object(s.a)(a,e);var t=Object(n.a)(a);function a(e){var r;return Object(i.a)(this,a),(r=t.call(this,e)).getItems=function(e){g.a.getRepoHistory(N,e,r.state.perPage).then((function(t){r.setState({isLoading:!1,currentPage:e,items:t.data.data,hasNextPage:t.data.more})})).catch((function(e){r.setState({isLoading:!1,errorMsg:j.a.getErrorMsg(e,!0)})}))},r.resetPerPage=function(e){r.setState({perPage:e},(function(){r.getItems(1)}))},r.onSearchedClick=function(e){if(!0===e.is_dir){var t=u.rc+"library/"+e.repo_id+"/"+e.repo_name+e.path;Object(d.c)(t,{repalce:!0})}else{var a=u.rc+"lib/"+e.repo_id+"/file"+j.a.encodePath(e.path);window.open("about:blank").location.href=a}},r.goBack=function(e){e.preventDefault(),window.history.back()},r.state={isLoading:!0,errorMsg:"",currentPage:1,perPage:25,hasNextPage:!1,items:[]},r}return Object(r.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,a=this.state,i=a.currentPage,r=a.perPage;this.setState({perPage:parseInt(t.get("per_page")||r),currentPage:parseInt(t.get("page")||i)},(function(){e.getItems(e.state.currentPage)}))}},{key:"render",value:function(){return Object(C.jsx)(o.a.Fragment,{children:Object(C.jsxs)("div",{className:"h-100 d-flex flex-column",children:[Object(C.jsxs)("div",{className:"top-header d-flex justify-content-between",children:[Object(C.jsx)("a",{href:u.rc,children:Object(C.jsx)("img",{src:u.Pb+u.Kb,height:u.Jb,width:u.Lb,title:u.sc,alt:"logo"})}),Object(C.jsx)(x.a,{onSearchedClick:this.onSearchedClick})]}),Object(C.jsx)("div",{className:"flex-auto container-fluid pt-4 pb-6 o-auto",children:Object(C.jsx)("div",{className:"row",children:Object(C.jsxs)("div",{className:"col-md-10 offset-md-1",children:[Object(C.jsx)("h2",{dangerouslySetInnerHTML:{__html:j.a.generateDialogTitle(Object(u.rb)("{placeholder} Modification History"),S)}}),Object(C.jsx)("a",{href:"#",className:"go-back",title:Object(u.rb)("Back"),onClick:this.goBack,role:"button","aria-label":Object(u.rb)("Back"),children:Object(C.jsx)("span",{className:"fas fa-chevron-left"})}),"rw"==k&&Object(C.jsx)("p",{className:"tip",children:Object(u.rb)("Tip: a snapshot will be generated after modification, which records the library state after the modification.")}),Object(C.jsx)(B,{isLoading:this.state.isLoading,errorMsg:this.state.errorMsg,items:this.state.items,currentPage:this.state.currentPage,hasNextPage:this.state.hasNextPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,getListByPage:this.getItems})]})})})]})})}}]),a}(o.a.Component),B=function(e){Object(s.a)(a,e);var t=Object(n.a)(a);function a(e){var r;return Object(i.a)(this,a),(r=t.call(this,e)).getPreviousPage=function(){r.props.getListByPage(r.props.currentPage-1)},r.getNextPage=function(){r.props.getListByPage(r.props.currentPage+1)},r.theadData=I?[{width:"43%",text:Object(u.rb)("Description")},{width:"12%",text:Object(u.rb)("Time")},{width:"9%",text:Object(u.rb)("Modifier")},{width:"12%",text:"".concat(Object(u.rb)("Device")," / ").concat(Object(u.rb)("Version"))},{width:"12%",text:Object(u.rb)("Labels")},{width:"12%",text:""}]:[{width:"43%",text:Object(u.rb)("Description")},{width:"15%",text:Object(u.rb)("Time")},{width:"15%",text:Object(u.rb)("Modifier")},{width:"15%",text:"".concat(Object(u.rb)("Device")," / ").concat(Object(u.rb)("Version"))},{width:"12%",text:""}],r}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.isLoading,a=e.errorMsg,i=e.items,r=e.curPerPage,s=e.currentPage,n=e.hasNextPage;return t?Object(C.jsx)(p.a,{}):a?Object(C.jsx)("p",{className:"error mt-6 text-center",children:a}):Object(C.jsxs)(o.a.Fragment,{children:[Object(C.jsxs)("table",{className:"table-hover",children:[Object(C.jsx)("thead",{children:Object(C.jsx)("tr",{children:this.theadData.map((function(e,t){return Object(C.jsx)("th",{width:e.width,children:e.text},t)}))})}),Object(C.jsx)("tbody",{children:i.map((function(e,t){return e.isFirstCommit=1==s&&0==t,e.showDetails=n||t!=i.length-1,Object(C.jsx)(E,{item:e},t)}))})]}),Object(C.jsx)(O.a,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:s,hasNextPage:n,curPerPage:r,resetPerPage:this.props.resetPerPage})]})}}]),a}(o.a.Component),E=function(e){Object(s.a)(a,e);var t=Object(n.a)(a);function a(e){var r;return Object(i.a)(this,a),(r=t.call(this,e)).handleMouseOver=function(){r.setState({isIconShown:!0})},r.handleMouseOut=function(){r.setState({isIconShown:!1})},r.showCommitDetails=function(e){e.preventDefault(),r.setState({isCommitDetailsDialogOpen:!r.state.isCommitDetailsDialogOpen})},r.toggleCommitDetailsDialog=function(){r.setState({isCommitDetailsDialogOpen:!r.state.isCommitDetailsDialogOpen})},r.editLabel=function(e){e.preventDefault(),r.setState({isCommitLabelUpdateDialogOpen:!r.state.isCommitLabelUpdateDialogOpen})},r.toggleLabelEditDialog=function(){r.setState({isCommitLabelUpdateDialogOpen:!r.state.isCommitLabelUpdateDialogOpen})},r.updateLabels=function(e){r.setState({labels:e})},r.state={labels:r.props.item.tags,isIconShown:!1,isCommitLabelUpdateDialogOpen:!1,isCommitDetailsDialogOpen:!1},r}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.item,t=this.state,a=t.isIconShown,i=t.isCommitLabelUpdateDialogOpen,r=t.isCommitDetailsDialogOpen,s=t.labels,n="";return n=e.email?e.second_parent_id?Object(u.rb)("None"):Object(C.jsx)("a",{href:"".concat(u.rc,"profile/").concat(encodeURIComponent(e.email),"/"),children:e.name}):Object(u.rb)("Unknown"),Object(C.jsxs)(o.a.Fragment,{children:[Object(C.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[Object(C.jsxs)("td",{children:[e.description,e.showDetails&&Object(C.jsx)("a",{href:"#",className:"details",onClick:this.showCommitDetails,role:"button",children:Object(u.rb)("Details")})]}),Object(C.jsx)("td",{title:m()(e.time).format("LLLL"),children:m()(e.time).format("YYYY-MM-DD")}),Object(C.jsx)("td",{children:n}),Object(C.jsx)("td",{children:e.client_version?"".concat(e.device_name," / ").concat(e.client_version):"API / --"}),I&&Object(C.jsxs)("td",{children:[s.map((function(e,t){return Object(C.jsx)("span",{className:"commit-label",children:e},t)})),"rw"==k&&Object(C.jsx)("a",{href:"#",role:"button",className:"attr-action-icon fa fa-pencil-alt ".concat(a?"":"invisible"),title:Object(u.rb)("Edit"),"aria-label":Object(u.rb)("Edit"),onClick:this.editLabel})]}),Object(C.jsx)("td",{children:"rw"==k&&(e.isFirstCommit?Object(C.jsx)("span",{className:a?"":"invisible",children:Object(u.rb)("Current Version")}):Object(C.jsx)("a",{href:"".concat(u.rc,"repo/").concat(N,"/snapshot/?commit_id=").concat(e.commit_id),className:a?"":"invisible",children:Object(u.rb)("View Snapshot")}))})]}),r&&Object(C.jsx)(f.a,{children:Object(C.jsx)(D.a,{repoID:N,commitID:e.commit_id,commitTime:e.time,toggleDialog:this.toggleCommitDetailsDialog})}),i&&Object(C.jsx)(f.a,{children:Object(C.jsx)(M,{repoID:N,commitID:e.commit_id,commitLabels:s,updateCommitLabels:this.updateLabels,toggleDialog:this.toggleLabelEditDialog})})]})}}]),a}(o.a.Component);b.a.render(Object(C.jsx)(_,{}),document.getElementById("wrapper"))},289:function(e,t,a){"use strict";var i=a(6),r=a(7),s=a(9),n=a(8),c=a(2),o=a.n(c),l=a(4),b=a(13),d=a.n(b),h=a(1),m=a(10),j=a(5),u=a(14),g=(a(463),a(0)),p=function(e){Object(s.a)(a,e);var t=Object(n.a)(a);function a(e){var r;return Object(i.a)(this,a),(r=t.call(this,e)).state={isLoading:!0,errorMsg:""},r}return Object(r.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.repoID,i=t.commitID;m.a.getCommitDetails(a,i).then((function(t){e.setState({isLoading:!1,errorMsg:"",commitDetails:t.data})})).catch((function(t){var a=j.a.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:a})}))}},{key:"render",value:function(){var e=this.props,t=e.toggleDialog;e.commitTime;return Object(g.jsxs)(l.u,{isOpen:!0,centered:!0,toggle:t,children:[Object(g.jsx)(l.x,{toggle:t,children:Object(h.rb)("Modification Details")}),Object(g.jsxs)(l.v,{children:[Object(g.jsx)("p",{className:"small",children:d()(this.props.commitTime).format("YYYY-MM-DD HH:mm:ss")}),Object(g.jsx)(O,{data:this.state})]})]})}}]),a}(o.a.Component),O=function(e){Object(s.a)(a,e);var t=Object(n.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(e=t.call.apply(t,[this].concat(s))).renderDetails=function(e){for(var t=[{type:"new",title:Object(h.rb)("New files")},{type:"removed",title:Object(h.rb)("Deleted files")},{type:"renamed",title:Object(h.rb)("Renamed or Moved files")},{type:"modified",title:Object(h.rb)("Modified files")},{type:"newdir",title:Object(h.rb)("New directories")},{type:"deldir",title:Object(h.rb)("Deleted directories")}],a=!0,i=0,r=t.length;i<r;i++)if(e[t[i].type].length){a=!1;break}return a?Object(g.jsx)("p",{children:e.cmt_desc}):Object(g.jsx)(o.a.Fragment,{children:t.map((function(t,a){if(e[t.type].length)return Object(g.jsxs)(o.a.Fragment,{children:[Object(g.jsx)("h6",{children:t.title}),Object(g.jsx)("ul",{children:e[t.type].map((function(e,t){return Object(g.jsx)("li",{dangerouslySetInnerHTML:{__html:e},className:"commit-detail-item"},t)}))})]},a)}))})},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.data,t=e.isLoading,a=e.errorMsg,i=e.commitDetails;return t?Object(g.jsx)(u.a,{}):a?Object(g.jsx)("p",{className:"error mt-4 text-center",children:a}):this.renderDetails(i)}}]),a}(o.a.Component);t.a=p},463:function(e,t,a){}},[[1553,1,0]]]);
//# sourceMappingURL=repoHistory.chunk.js.map